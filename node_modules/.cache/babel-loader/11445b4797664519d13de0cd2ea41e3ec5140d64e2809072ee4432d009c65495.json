{"ast":null,"code":"import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createBlock as _createBlock, withCtx as _withCtx, createVNode as _createVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-c3c9c112\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  style: {\n    \"width\": \"100%\",\n    \"height\": \"100%\"\n  }\n};\nconst _hoisted_2 = {\n  style: {\n    \"width\": \"100%\",\n    \"margin-bottom\": \"5%\",\n    \"height\": \"10%\"\n  }\n};\nconst _hoisted_3 = {\n  class: \"select\"\n};\nconst _hoisted_4 = {\n  class: \"container\"\n};\nconst _hoisted_5 = {\n  style: {\n    \"display\": \"flex\",\n    \"flex-wrap\": \"wrap\",\n    \"margin\": \"2.5%\"\n  }\n};\nconst _hoisted_6 = {\n  style: {\n    \"display\": \"flex\",\n    \"justify-content\": \"space-between\"\n  }\n};\nconst _hoisted_7 = {\n  style: {\n    \"font-weight\": \"bold\",\n    \"color\": \"#ffa31a\"\n  }\n};\nconst _hoisted_8 = [\"src\"];\nconst _hoisted_9 = {\n  style: {\n    \"display\": \"flex\",\n    \"justify-content\": \"space-between\"\n  }\n};\nconst _hoisted_10 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"text\", null, \"数量\", -1 /* HOISTED */));\nconst _hoisted_11 = {\n  style: {\n    \"position\": \"fixed\",\n    \"bottom\": \"2%\",\n    \"right\": \"1%\"\n  }\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_option = _resolveComponent(\"el-option\");\n  const _component_el_select = _resolveComponent(\"el-select\");\n  const _component_el_date_picker = _resolveComponent(\"el-date-picker\");\n  const _component_el_radio_button = _resolveComponent(\"el-radio-button\");\n  const _component_el_radio_group = _resolveComponent(\"el-radio-group\");\n  const _component_el_popover = _resolveComponent(\"el-popover\");\n  const _component_Search = _resolveComponent(\"Search\");\n  const _component_el_icon = _resolveComponent(\"el-icon\");\n  const _component_v_card = _resolveComponent(\"v-card\");\n  const _component_el_input_number = _resolveComponent(\"el-input-number\");\n  const _component_el_card = _resolveComponent(\"el-card\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_v_card, {\n    hover: \"\",\n    style: {\n      \"background-color\": \"#e4f5ff\",\n      \"border-radius\": \"25px\",\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"display\": \"block\"\n    }\n  }, {\n    default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_el_select, {\n      modelValue: $setup.tid,\n      \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.tid = $event),\n      placeholder: \"车次\",\n      class: \"item\",\n      \"popper-class\": _ctx.popperClass\n    }, {\n      default: _withCtx(() => [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.Paidticket, item => {\n        return _openBlock(), _createBlock(_component_el_option, {\n          key: item,\n          label: item,\n          value: item\n        }, null, 8 /* PROPS */, [\"label\", \"value\"]);\n      }), 128 /* KEYED_FRAGMENT */))]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"modelValue\", \"popper-class\"]), _createVNode(_component_el_date_picker, {\n      class: \"item\",\n      modelValue: $setup.date,\n      \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.date = $event),\n      type: \"date\",\n      placeholder: \"出发日期\",\n      shortcuts: _ctx.shortcuts,\n      size: 20\n    }, null, 8 /* PROPS */, [\"modelValue\", \"shortcuts\"]), _createVNode(_component_el_popover, {\n      placement: \"top-start\",\n      width: \"13em\",\n      trigger: \"hover\",\n      content: \"午餐点为12:00--14:00  晚餐点为17:00--19:00\"\n    }, {\n      reference: _withCtx(() => [_createVNode(_component_el_radio_group, {\n        modelValue: $setup.time,\n        \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $setup.time = $event),\n        style: {\n          \"margin-right\": \"10px\",\n          \"margin-left\": \"10px\",\n          \"flex\": \"0.3\",\n          \"justify-content\": \"center\"\n        }\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_radio_button, {\n          label: \"午餐\",\n          value: \"lunch\"\n        }), _createVNode(_component_el_radio_button, {\n          label: \"晚餐\",\n          value: \"dinner\"\n        })]),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"modelValue\"])]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_icon, {\n      style: {\n        \"flex\": \"0.1\"\n      }\n    }, {\n      default: _withCtx(() => [_createVNode(_component_Search, {\n        onClick: $setup.search,\n        style: {\n          \"background-color\": \"orange\",\n          \"width\": \"30px\",\n          \"height\": \"200%\",\n          \"border-radius\": \"5px\"\n        }\n      })]),\n      _: 1 /* STABLE */\n    })])]),\n    _: 1 /* STABLE */\n  })]), _createElementVNode(\"div\", _hoisted_4, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.foodList, (item, index) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: index\n    }, [_createElementVNode(\"div\", _hoisted_5, [_createVNode(_component_el_card, {\n      shadow: \"hover\"\n    }, {\n      header: _withCtx(() => [_createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"div\", null, _toDisplayString(item.name), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_7, \" ￥\" + _toDisplayString(item.price), 1 /* TEXT */)])]),\n      footer: _withCtx(() => [_createElementVNode(\"div\", _hoisted_9, [_hoisted_10, _createVNode(_component_el_input_number, {\n        modelValue: item.num,\n        \"onUpdate:modelValue\": $event => item.num = $event,\n        size: \"small\",\n        min: 0\n      }, null, 8 /* PROPS */, [\"modelValue\", \"onUpdate:modelValue\"])])]),\n      default: _withCtx(() => [_createElementVNode(\"img\", {\n        loading: \"lazy\",\n        referrerpolicy: \"no-referrer\",\n        \"object-fit\": \"contain\",\n        src: item.photo,\n        style: {\n          \"width\": \"15em\",\n          \"height\": \"15em\",\n          \"display\": \"block\",\n          \"margin-left\": \"auto\",\n          \"margin-right\": \"auto\"\n        }\n      }, null, 8 /* PROPS */, _hoisted_8)]),\n      _: 2 /* DYNAMIC */\n    }, 1024 /* DYNAMIC_SLOTS */)])]);\n  }), 128 /* KEYED_FRAGMENT */))])]), _createElementVNode(\"div\", _hoisted_11, [_createVNode($setup[\"foodCart\"], {\n    modelValue: $setup.order_foods,\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $setup.order_foods = $event),\n    onGetPaid: _ctx.submitBill\n  }, null, 8 /* PROPS */, [\"modelValue\", \"onGetPaid\"])])], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"names":["style","class","_createElementVNode","_createElementBlock","_Fragment","_hoisted_1","_hoisted_2","_createVNode","_component_v_card","hover","default","_withCtx","_hoisted_3","_component_el_select","modelValue","$setup","tid","_cache","$event","placeholder","_ctx","popperClass","_renderList","Paidticket","item","_createBlock","_component_el_option","key","label","value","_","_component_el_date_picker","date","type","shortcuts","size","_component_el_popover","placement","width","trigger","content","reference","_component_el_radio_group","time","_component_el_radio_button","_component_el_icon","_component_Search","onClick","search","_hoisted_4","foodList","index","_hoisted_5","_component_el_card","shadow","header","_hoisted_6","_toDisplayString","name","_hoisted_7","price","footer","_hoisted_9","_hoisted_10","_component_el_input_number","num","min","loading","referrerpolicy","src","photo","_hoisted_8","_hoisted_11","order_foods","onGetPaid","submitBill"],"sources":["D:\\University\\sophomore\\Software engineering\\werwer_train\\src\\components\\bookFood.vue"],"sourcesContent":["<template>\r\n  <div style=\"width: 100%; height: 100%\">\r\n    <div style=\"width: 100%; margin-bottom: 5%; height: 10%\">\r\n      <v-card\r\n        hover\r\n        style=\"\r\n          background-color: #e4f5ff;\r\n          border-radius: 25px;\r\n          width: 100%;\r\n          height: 100%;\r\n          display: block;\r\n        \"\r\n      >\r\n        <div class=\"select\">\r\n          <el-select\r\n            v-model=\"tid\"\r\n            placeholder=\"车次\"\r\n            class=\"item\"\r\n            :popper-class=\"popperClass\"\r\n          >\r\n            <el-option\r\n              v-for=\"item in Paidticket\"\r\n              :key=\"item\"\r\n              :label=\"item\"\r\n              :value=\"item\"\r\n            >\r\n            </el-option>\r\n          </el-select>\r\n          <el-date-picker\r\n            class=\"item\"\r\n            v-model=\"date\"\r\n            type=\"date\"\r\n            placeholder=\"出发日期\"\r\n            :shortcuts=\"shortcuts\"\r\n            :size=\"20\"\r\n          />\r\n          <el-popover\r\n            placement=\"top-start\"\r\n            width=\"13em\"\r\n            trigger=\"hover\"\r\n            content=\"午餐点为12:00--14:00  晚餐点为17:00--19:00\"\r\n          >\r\n            <template #reference>\r\n              <el-radio-group\r\n                v-model=\"time\"\r\n                style=\"\r\n                  margin-right: 10px;\r\n                  margin-left: 10px;\r\n                  flex: 0.3;\r\n                  justify-content: center;\r\n                \"\r\n              >\r\n                <el-radio-button label=\"午餐\" value=\"lunch\" />\r\n                <el-radio-button label=\"晚餐\" value=\"dinner\" /> </el-radio-group\r\n            ></template>\r\n          </el-popover>\r\n          <el-icon style=\"flex: 0.1\">\r\n            <Search\r\n              @click=\"search\"\r\n              style=\"\r\n                background-color: orange;\r\n                width: 30px;\r\n                height: 200%;\r\n                border-radius: 5px;\r\n              \"\r\n            />\r\n          </el-icon>\r\n        </div>\r\n      </v-card>\r\n    </div>\r\n\r\n    <div class=\"container\">\r\n      <div v-for=\"(item, index) in foodList\" :key=\"index\">\r\n        <div style=\"display: flex; flex-wrap: wrap; margin: 2.5%\">\r\n          <el-card shadow=\"hover\">\r\n            <template #header>\r\n              <div style=\"display: flex; justify-content: space-between\">\r\n                <div>{{ item.name }}</div>\r\n                <div style=\"font-weight: bold; color: #ffa31a\">\r\n                  ￥{{ item.price }}\r\n                </div>\r\n              </div>\r\n            </template>\r\n            <img\r\n              loading=\"lazy\"\r\n              referrerpolicy=\"no-referrer\"\r\n              object-fit=\"contain\"\r\n              :src=\"item.photo\"\r\n              style=\"\r\n                width: 15em;\r\n                height: 15em;\r\n                display: block;\r\n                margin-left: auto;\r\n                margin-right: auto;\r\n              \"\r\n            />\r\n            <template #footer>\r\n              <div style=\"display: flex; justify-content: space-between\">\r\n                <text>数量</text>\r\n                <el-input-number v-model=\"item.num\" size=\"small\" :min=\"0\" />\r\n              </div>\r\n            </template>\r\n          </el-card>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div style=\"position: fixed; bottom: 2%; right: 1%\">\r\n    <foodCart v-model=\"order_foods\" @getPaid=\"submitBill\" />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, watch } from \"vue\";\r\nimport foodCart from \"./foodCart.vue\";\r\nimport { getFoods, getThisTicket, postFoodBill } from \"@/api/api\";\r\nimport { ElMessage } from \"element-plus\";\r\nconst userID = \"00000\"; //当前用户ID\r\nconst tid = ref(\"\");\r\nconst date = ref(\"\"); //TODO date自动填充逻辑！\r\nconst time = ref(\"lunch\");\r\nconst foodList = ref([]);\r\n\r\nconst order_foods = ref([]); //已点的食物\r\nconst Paidticket = ref([]);\r\nconst search = () => {\r\n  if (tid.value === \"\" || time.value === \"\" || date.value === \"\") {\r\n    ElMessage({\r\n      message: \"还有没填写的信息\",\r\n      type: \"error\",\r\n      plain: true,\r\n    });\r\n  } else {\r\n    fetchFoods();\r\n  }\r\n};\r\nconst fetchFoods = async () => {\r\n  try {\r\n    const response = await getFoods(userID,tid, date, time);\r\n    if (response.data.haveTicket) {\r\n      foodList.value = response.data.result;\r\n      ElMessage({\r\n        message: \"查询成功\",\r\n        type: \"success\",\r\n      });\r\n    } else {\r\n      ElMessage.error(\"查询失败T^T\" + response.data.info);\r\n      foodList.value = [];\r\n    }\r\n  } catch (error) {\r\n    console.error(\"获取食物数组失败:\", error);\r\n  }\r\n};\r\n\r\nconst fetchTids = async () => {\r\n  try {\r\n    const response = await getThisTicket(userID, \"paid\");\r\n    var ticket = response.data.result;\r\n    var tempList = [];\r\n    for (var item of ticket) {\r\n      tempList.push(item.tid);\r\n    }\r\n    Paidticket.value = tempList;\r\n  } catch (error) {\r\n    console.error(\"获取车站数组失败：\", error);\r\n  }\r\n};\r\n\r\n\r\nwatch(\r\n  foodList,\r\n  (newFoodList) => {\r\n    // 当 num 大于 0 时，将该项加入 order_foods\r\n    order_foods.value = newFoodList.filter((item) => item.num > 0);\r\n    console.log(\"修改了购物车内容\");\r\n  },\r\n  { deep: true },\r\n  { immediate: true }\r\n);\r\nonMounted(() => {\r\n  fetchTids();\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n.item {\r\n  flex: 1;\r\n  margin-right: 10px;\r\n  margin-left: 10px;\r\n  margin: auto;\r\n}\r\n.container {\r\n  display: flex;\r\n  flex-wrap: wrap; /* 设置子元素自动换行 */\r\n  justify-content: center;\r\n  position: absolute;\r\n  z-index: 0;\r\n  background-color: white;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}