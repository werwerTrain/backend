{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref, onMounted, computed, inject } from \"vue\";\nimport { useRouter } from \"vue-router\";\nimport eventBus from \"@/eventBus.js\";\nimport { getMessage } from \"@/api/api.js\";\nimport { ElMessage, ElMessageBox } from 'element-plus';\nimport { postLogin } from \"@/api/api\";\nimport { postRegister, postCode, postCodeVeryfication } from \"@/api/api\";\nconst userID = \"0000\";\nconst countdownSeconds = 120;\nexport default {\n  __name: 'HomeView',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const router = useRouter();\n    const activeIndex = ref(\"1\");\n    const drawer = ref(false);\n    const selectMenu = key => {\n      console.log(\"当前选中为\" + key);\n      activeIndex.value = key;\n      eventBus.MyOrdersActiveKey = \"1\";\n      if (activeIndex.value === \"1\") {\n        router.push(\"/home/ticket\");\n      } else if (activeIndex.value === \"2\") {\n        router.push(\"/home/hotel\");\n      } else if (activeIndex.value === \"3\") {\n        router.push(\"/home/dining\");\n      } else if (activeIndex.value === \"4\") {\n        router.push(\"/home/orders\");\n      }\n    };\n    // const message = ref([\n    //   {\n    //     title: \"车票提醒\",\n    //     messageTime: \"2020-03-10\",\n    //     content:\n    //       \"您已购买2024-05-09 G5车次 杭州--->北京车次，发车时间05月09日08:00。请合理安排出行时间。\",\n    //     haveRead: true,\n    //     orderType:\"3\",\n    //     orderId: \"string3\",\n    //   },\n    //   {\n    //     title: \"订单取消\",\n    //     messageTime: \"2024-09-12\",\n    //     content: \"您已下单2024-10-20 G81车次 午餐餐品。将由列车员送到座位上。\",\n    //     haveRead: false,\n    //     orderType:\"5\",\n    //     orderId: \"string4\",\n    //   },\n    // ]);\n    const message = ref([]);\n    const unReadNum = computed(() => {\n      return message.value.filter(msg => !msg.haveRead).length;\n    });\n\n    //登陆\n\n    const openLogin = ref(false);\n    const my_id = ref('');\n    const my_password = ref('');\n    const login = () => {\n      openLogin.value = true;\n    };\n    const handleLoginOk = e => {\n      console.log(e);\n      if (my_id.value === \"\" || my_password.value === \"\") {\n        ElMessage({\n          message: \"还有没填写的信息\",\n          type: \"error\",\n          plain: true\n        });\n      } else {\n        postmyLogin();\n        openLogin.value = false;\n      }\n    };\n    const postmyLogin = async () => {\n      try {\n        const response = await postLogin(my_id, my_password);\n        if (response.data.result) {\n          ElMessage({\n            message: \"登陆成功\",\n            type: \"success\"\n          });\n          localStorage.setItem('user_id', my_id);\n          localStorage.setItem('isLoggedIn', true);\n          localStorage.setItem('email', response.data.email);\n          localStorage.setItem('password', my_password);\n          localStorage.setItem('name', response.data.name);\n          updateUI();\n          //重新加载页面\n          window.location.href = window.location.href;\n        } else {\n          ElMessage.error(\"登陆失败:用户ID或密码错误\");\n        }\n      } catch (error) {\n        console.error(\"登陆失败:\", error);\n      }\n    };\n\n    //注册\n    const my_email = ref('');\n    const my_name = ref('');\n    const my_verify = ref('');\n    const my_code = ref('');\n    const openRegister = ref(false);\n    const openVerification = ref(false);\n    const register = () => {\n      openRegister.value = true;\n    };\n    const postmyRegister = async () => {\n      try {\n        const response = await postRegister(my_id, my_name, my_password, my_email);\n        if (response.data.result) {\n          ElMessage({\n            message: \"提交成功\",\n            type: \"success\"\n          });\n          localStorage.setItem('user_id', my_id);\n          localStorage.setItem('email', my_email);\n          localStorage.setItem('password', my_password);\n          localStorage.setItem('name', my_name);\n          openRegister.value = false;\n          openVerification.value = true;\n        } else {\n          ElMessage.error(\"提交失败:\" + response.data.reason);\n        }\n      } catch (error) {\n        console.error(\"提交失败:\", error);\n      }\n    };\n    //发送验证码\n\n    const sendVerificationOk = async () => {\n      try {\n        const response = await postCode(my_email);\n        if (response.data.result) {\n          ElMessage({\n            message: \"成功发送验证码\",\n            type: \"success\"\n          });\n          if (!countingDown.value) {\n            startCountdown();\n            // 在这里发送验证码的逻辑\n          }\n        } else {\n          ElMessage.error(\"验证码发送失败\");\n        }\n      } catch (error) {\n        console.error(\"验证码发送失败:\", error);\n      }\n    };\n    const handleVerificationOk = async () => {\n      try {\n        const response = await postCodeVeryfication(my_code, my_email);\n        if (response.data.result) {\n          ElMessage({\n            message: \"注册成功\",\n            type: \"success\"\n          });\n          openVerification.value = false;\n          localStorage.setItem('isLoggedIn', true);\n          updateUI();\n          //重新加载页面\n          window.location.href = window.location.href;\n        } else {\n          ElMessage.error(\"验证码错误，请重新输入\");\n        }\n      } catch (error) {\n        console.error(\"验证码发送失败:\", error);\n      }\n    };\n    //倒计时\n    const countingDown = ref(false);\n    const buttonText = ref('发送验证码');\n    function startCountdown() {\n      countingDown.value = true;\n      let seconds = countdownSeconds;\n      buttonText.value = `${seconds}s`;\n      const countdownInterval = setInterval(() => {\n        seconds--;\n        buttonText.value = `${seconds}s`;\n        if (seconds <= 0) {\n          clearInterval(countdownInterval);\n          countingDown.value = false;\n          buttonText.value = '发送验证码';\n        }\n      }, 1000);\n    }\n    const handleRegisterOk = e => {\n      console.log(e);\n      if (my_id.value === \"\" || my_password.value === \"\" || my_email.value === \"\" || my_name === \"\") {\n        ElMessage({\n          message: \"还有没填写的信息\",\n          type: \"error\",\n          plain: true\n        });\n      } else {\n        postmyRegister();\n      }\n    };\n    const changeToRegister = () => {\n      openLogin.value = false;\n      openRegister.value = true;\n      updateUI();\n    };\n\n    // 页面加载完成时执行\n    document.addEventListener('DOMContentLoaded', function () {\n      // 更新页面元素的显示状态\n      updateUI();\n    });\n\n    // 更新页面元素显示状态的函数\n    function updateUI() {\n      var isLoggedIn = localStorage.getItem('isLoggedIn');\n\n      // 根据 isLoggedIn 的值更新页面元素显示状态\n      if (isLoggedIn === 'true') {\n        document.getElementById('loginButton').style.display = 'none'; // 隐藏登录按钮\n        document.getElementById('loggedInMessage').style.display = 'block'; // 显示已登录的消息\n      } else {\n        document.getElementById('loginButton').style.display = 'block'; // 显示登录按钮\n        document.getElementById('loggedInMessage').style.display = 'none'; // 隐藏已登录的消息\n      }\n    }\n    //退出登录\n\n    const quit = () => {\n      localStorage.setItem('user_id', \"\");\n      localStorage.setItem('isLoggedIn', false);\n      localStorage.setItem('email', \"\");\n      localStorage.setItem('password', \"\");\n      localStorage.setItem('name', \"\");\n      updateUI();\n    };\n    onMounted(() => {\n      router.push(\"/home/ticket\");\n      getAllMessage();\n    });\n    const getAllMessage = async () => {\n      //TODO 判断是否登录\n      try {\n        const responce = await getMessage(userID);\n        message.value = responce.data.result;\n      } catch (error) {\n        console.log(\"获取消息失败\", error);\n      }\n    };\n    const jumpToOrder = (orderType, orderId) => {\n      eventBus.HeaderKey = \"4\";\n      activeIndex.value = \"4\";\n      //TODO 依据不同情况修改\n      eventBus.MyOrdersActiveKey = orderType;\n      if (orderType === \"3\") {\n        router.push(\"/home/orders/ticketOrders\");\n        router.push({\n          path: \"/home/orders/ticketOrders\",\n          query: {\n            orderId: orderId\n          }\n        });\n      } else if (orderType === \"4\") {\n        router.push({\n          path: \"/home/orders/hotelOrders\",\n          query: {\n            orderId: orderId\n          }\n        });\n      } else if (orderType === \"5\") {\n        router.push({\n          path: \"/home/orders/foodOrders\",\n          query: {\n            orderId: orderId\n          }\n        });\n      }\n    };\n\n    // setInterval(getAllMessage,1000);\n\n    const __returned__ = {\n      router,\n      activeIndex,\n      drawer,\n      selectMenu,\n      message,\n      userID,\n      unReadNum,\n      openLogin,\n      my_id,\n      my_password,\n      login,\n      handleLoginOk,\n      postmyLogin,\n      my_email,\n      my_name,\n      my_verify,\n      my_code,\n      openRegister,\n      openVerification,\n      register,\n      postmyRegister,\n      sendVerificationOk,\n      handleVerificationOk,\n      countdownSeconds,\n      countingDown,\n      buttonText,\n      startCountdown,\n      handleRegisterOk,\n      changeToRegister,\n      updateUI,\n      quit,\n      getAllMessage,\n      jumpToOrder,\n      ref,\n      onMounted,\n      computed,\n      inject,\n      get useRouter() {\n        return useRouter;\n      },\n      get eventBus() {\n        return eventBus;\n      },\n      get getMessage() {\n        return getMessage;\n      },\n      get ElMessage() {\n        return ElMessage;\n      },\n      get ElMessageBox() {\n        return ElMessageBox;\n      },\n      get postLogin() {\n        return postLogin;\n      },\n      get postRegister() {\n        return postRegister;\n      },\n      get postCode() {\n        return postCode;\n      },\n      get postCodeVeryfication() {\n        return postCodeVeryfication;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","computed","inject","useRouter","eventBus","getMessage","ElMessage","ElMessageBox","postLogin","postRegister","postCode","postCodeVeryfication","userID","countdownSeconds","router","activeIndex","drawer","selectMenu","key","console","log","value","MyOrdersActiveKey","push","message","unReadNum","filter","msg","haveRead","length","openLogin","my_id","my_password","login","handleLoginOk","e","type","plain","postmyLogin","response","data","result","localStorage","setItem","email","name","updateUI","window","location","href","error","my_email","my_name","my_verify","my_code","openRegister","openVerification","register","postmyRegister","reason","sendVerificationOk","countingDown","startCountdown","handleVerificationOk","buttonText","seconds","countdownInterval","setInterval","clearInterval","handleRegisterOk","changeToRegister","document","addEventListener","isLoggedIn","getItem","getElementById","style","display","quit","getAllMessage","responce","jumpToOrder","orderType","orderId","HeaderKey","path","query"],"sources":["D:/University/sophomore/Software engineering/werwer_train/src/views/HomeView.vue"],"sourcesContent":["<template>\r\n  <el-container class=\"home-container\">\r\n    <el-header\r\n      style=\"display: flex; align-items: center; justify-content: space-between\"\r\n    >\r\n      <div style=\"display: flex; align-items: center\">\r\n        <img\r\n          src=\"../assets/logo2.png\"\r\n          style=\"width: 100px; height: 55px; margin-top: 3%\"\r\n        />\r\n        <el-menu\r\n          :default-active=\"activeIndex\"\r\n          class=\"menu\"\r\n          mode=\"horizontal\"\r\n          :ellipsis=\"false\"\r\n          @select=\"selectMenu\"\r\n          style=\"color: black; margin-top: 2%\"\r\n        >\r\n          <el-menu-item\r\n            index=\"1\"\r\n            style=\"color: black; font-weight: bold; font-size: 17px\"\r\n            >火车订票</el-menu-item\r\n          >\r\n          <el-menu-item\r\n            index=\"2\"\r\n            style=\"color: black; font-weight: bold; font-size: 17px\"\r\n            >酒店预订</el-menu-item\r\n          >\r\n          <el-menu-item\r\n            index=\"3\"\r\n            style=\"color: black; font-weight: bold; font-size: 17px\"\r\n            >火车订餐</el-menu-item\r\n          >\r\n          <el-menu-item\r\n            index=\"4\"\r\n            style=\"color: black; font-weight: bold; font-size: 17px\"\r\n            >我的</el-menu-item\r\n          >\r\n        </el-menu>\r\n      </div>\r\n      <div style=\"display: flex; align-items: center;\">\r\n        <div style=\"display: flex; align-items: center;\">\r\n        <el-popover\r\n          placement=\"bottom\"\r\n          :width=\"200\"\r\n          trigger=\"click\"\r\n          content=\"this is content, this is content, this is content\"\r\n        >\r\n          <template #reference >\r\n            <el-button id=\"loginButton\" type=\"primary\" round plain size=\"large\" style=\"margin-top:12%;margin-right:3%;\" class=\"log\">登录/注册</el-button>\r\n            \r\n          </template>\r\n          <!-- 登陆 -->\r\n          <div>\r\n            <a-button @click=\"login\" style=\"width:170px;\">\r\n              登录\r\n            </a-button>\r\n            <a-modal v-model:open=\"openLogin\" title=\"登陆\" @ok=\"handleLoginOk\">\r\n              <div style=\"margin-top:20px;\">\r\n                <el-input\r\n                  v-model=\"my_id\"\r\n                  style=\"max-width: 600px\"\r\n                  placeholder=\"输入身份证号\"\r\n                >\r\n                  <template #prepend>ID号</template>\r\n                </el-input>\r\n              </div>\r\n              <div style=\"margin-top:20px;\">\r\n                <el-input\r\n                  v-model=\"my_password\"\r\n                  style=\"max-width: 600px\"\r\n                  placeholder=\"输入密码\"\r\n                >\r\n                  <template #prepend>密码</template>\r\n                </el-input>\r\n              </div>\r\n              <button style=\"margin-top:20px;color:#61bbff;text-decoration:underline;\" @click=\"changeToRegister\">\r\n                先去注册\r\n              </button>\r\n            </a-modal>\r\n\r\n          </div>\r\n          <!-- 注册 -->\r\n          <div>\r\n            <a-button @click=\"register\" style=\"width:170px;margin-top:10px;\">\r\n              注册\r\n            </a-button>\r\n            <a-modal v-model:open=\"openRegister\" title=\"注册\" @ok=\"handleRegisterOk\" ok-text=\"确认信息\" style=\"color:white\" :cancel-button-props=\"{ style: { display: 'none' } }\">\r\n              <div style=\"margin-top:20px;\">\r\n                <el-input\r\n                  v-model=\"my_id\"\r\n                  style=\"max-width: 600px\"\r\n                  placeholder=\"输入身份证号\"\r\n                >\r\n                  <template #prepend>ID号</template>\r\n                </el-input>\r\n              </div>\r\n              <div style=\"margin-top:20px;\">\r\n                <el-input\r\n                  v-model=\"my_name\"\r\n                  style=\"max-width: 600px\"\r\n                  placeholder=\"输入姓名\"\r\n                >\r\n                  <template #prepend>姓名</template>\r\n                </el-input>\r\n              </div>\r\n              <div style=\"margin-top:20px;\">\r\n                <el-input\r\n                  v-model=\"my_password\"\r\n                  style=\"max-width: 600px\"\r\n                  placeholder=\"输入密码\"\r\n                >\r\n                  <template #prepend>密码</template>\r\n                </el-input>\r\n              </div>\r\n              <div style=\"margin-top:20px;\">\r\n                <el-input\r\n                  v-model=\"my_email\"\r\n                  style=\"max-width: 600px\"\r\n                  placeholder=\"输入邮箱\"\r\n                >\r\n                  <template #prepend>邮箱</template>\r\n                </el-input>\r\n              </div>\r\n            </a-modal>\r\n          </div>\r\n          <a-modal v-model:open=\"openVerification\" title=\"注册\"  :cancel-button-props=\"{ style: { display: 'none' } }\" :ok-button-props=\"{ style: { display: 'none' } }\">\r\n              \r\n              <div style=\"margin-top:20px;\">\r\n                <el-button style=\"width:100px;margin-right:20px;\" @click=\"sendVerificationOk\" :disabled=\"countingDown\"> {{ buttonText }} </el-button>\r\n                <el-input\r\n                  v-model=\"my_code\"\r\n                  style=\"max-width: 230px\"\r\n                  placeholder=\"输入验证码\"\r\n                >\r\n                  <template #prepend>验证码</template>\r\n                </el-input>\r\n                <el-button @click=\"handleVerificationOk\" style=\"margin-left:20px\" type=\"primary\"> 提交验证码 </el-button>\r\n              </div>\r\n            </a-modal>\r\n\r\n        </el-popover>\r\n        <div id=\"loggedInMessage\" style=\"display:none\">\r\n              <div style=\"marigin-top:30px;\">\r\n                <el-popover\r\n                  placement=\"bottom\"\r\n                  :width=\"200\"\r\n                  trigger=\"hover\"\r\n                  content=\"this is content, this is content, this is content\"\r\n                >\r\n                  <a-button @click=\"quit\" style=\"width:170px;margin-top:10px;\">\r\n                    退出登录\r\n                  </a-button>\r\n                  <template #reference>\r\n                    <a-avatar style=\"margin-top:10px;margin-right:20px;\" size=\"large\" :src=\"'https://m.elongstatic.com/hotel_pc_i18n/product/_nuxt/userHead.0-0-3-213881db..svg'\" />\r\n                  </template>\r\n                </el-popover>\r\n              </div>\r\n        </div>\r\n        <el-badge\r\n          :value=\"unReadNum\"\r\n          :show-zero=\"false\"\r\n          :max=\"10\"\r\n          style=\"margin-top: 8%; margin-right: 1em\"\r\n        >\r\n        <img src=\"../assets/message.png\" style=\"width: 50px; height: 50px;\" @click=\"drawer = true\" /> </el-badge>\r\n      </div>\r\n      </div>\r\n    </el-header>\r\n    <div class=\"main\">\r\n      <el-main width=\"80%\" style=\"height: 90vh\">\r\n        <router-view />\r\n      </el-main>\r\n    </div>\r\n\r\n    <!-- 弹出消息栏 -->\r\n    <el-drawer v-model=\"drawer\" title=\"消息\" direction=\"rtl\" size=\"35%\">\r\n      <div v-for=\"(item, index) in message\" :key=\"index\">\r\n        <el-card\r\n          style=\"border-radius: 15px; margin-bottom: 5%\"\r\n          @click=\"\r\n            item.haveRead = true;\r\n            jumpToOrder(item.orderType, item.orderId);\r\n          \"\r\n        >\r\n          <template #header>\r\n            <div style=\"display: flex; justify-content: space-between\">\r\n              <el-badge is-dot :hidden=\"item.haveRead\">\r\n                <span style=\"margin-top: 0.3em; margin-right: 0.3em\">\r\n                  {{ item.title }}\r\n                </span>\r\n              </el-badge>\r\n              <span style=\"color: #dedfe0\">{{ item.messageTime }}</span>\r\n            </div>\r\n          </template>\r\n          <text>{{ item.content }}</text>\r\n          <span style=\"vertical-align: middle; text-align: center\">\r\n            <text style=\"color: #a0cfff\">查看详细信息</text>\r\n            <el-icon style=\"color: #a0cfff\"><DArrowRight /></el-icon>\r\n          </span>\r\n        </el-card>\r\n      </div>\r\n    </el-drawer>\r\n  </el-container>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, computed,inject } from \"vue\";\r\nimport { useRouter } from \"vue-router\";\r\nimport eventBus from \"@/eventBus.js\";\r\nimport { getMessage } from \"@/api/api.js\";\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\nconst router = useRouter();\r\nconst activeIndex = ref(\"1\");\r\nconst drawer = ref(false);\r\nconst selectMenu = (key) => {\r\n  console.log(\"当前选中为\" + key);\r\n  activeIndex.value = key;\r\n  eventBus.MyOrdersActiveKey = \"1\";\r\n  if (activeIndex.value === \"1\") {\r\n    router.push(\"/home/ticket\");\r\n  } else if (activeIndex.value === \"2\") {\r\n    router.push(\"/home/hotel\");\r\n  } else if (activeIndex.value === \"3\") {\r\n    router.push(\"/home/dining\");\r\n  } else if (activeIndex.value === \"4\") {\r\n    router.push(\"/home/orders\");\r\n  }\r\n};\r\n// const message = ref([\r\n//   {\r\n//     title: \"车票提醒\",\r\n//     messageTime: \"2020-03-10\",\r\n//     content:\r\n//       \"您已购买2024-05-09 G5车次 杭州--->北京车次，发车时间05月09日08:00。请合理安排出行时间。\",\r\n//     haveRead: true,\r\n//     orderType:\"3\",\r\n//     orderId: \"string3\",\r\n//   },\r\n//   {\r\n//     title: \"订单取消\",\r\n//     messageTime: \"2024-09-12\",\r\n//     content: \"您已下单2024-10-20 G81车次 午餐餐品。将由列车员送到座位上。\",\r\n//     haveRead: false,\r\n//     orderType:\"5\",\r\n//     orderId: \"string4\",\r\n//   },\r\n// ]);\r\nconst message = ref([]);\r\nconst userID = \"0000\";\r\nconst unReadNum = computed(() => {\r\n  return message.value.filter((msg) => !msg.haveRead).length;\r\n});\r\n\r\n//登陆\r\n\r\nimport { postLogin } from \"@/api/api\"\r\nconst openLogin = ref(false);\r\nconst my_id = ref('');\r\nconst my_password = ref('');\r\n\r\nconst login = () => {\r\n  openLogin.value = true;\r\n};\r\n\r\nconst handleLoginOk = (e) => {\r\n  console.log(e);\r\n  if (my_id.value === \"\" || my_password.value === \"\") {\r\n    ElMessage({\r\n      message: \"还有没填写的信息\",\r\n      type: \"error\",\r\n      plain: true,\r\n    });\r\n  } else {\r\n    postmyLogin();\r\n    openLogin.value = false;\r\n  }\r\n};\r\nconst postmyLogin = async () =>{\r\n  try{\r\n    const response = await postLogin(my_id,my_password);\r\n    if(response.data.result){\r\n      ElMessage({\r\n        message: \"登陆成功\",\r\n        type: \"success\",\r\n      });\r\n      localStorage.setItem('user_id',my_id);\r\n      localStorage.setItem('isLoggedIn',true);\r\n      localStorage.setItem('email',response.data.email);\r\n      localStorage.setItem('password',my_password);\r\n      localStorage.setItem('name',response.data.name);\r\n      updateUI();\r\n      //重新加载页面\r\n      window.location.href = window.location.href;\r\n    }else{\r\n      ElMessage.error(\"登陆失败:用户ID或密码错误\");\r\n    }\r\n  }catch (error) {\r\n    console.error(\"登陆失败:\", error);\r\n  }\r\n}\r\n\r\n\r\n\r\n//注册\r\nconst my_email = ref('');\r\nconst my_name = ref('');\r\nconst my_verify= ref('');\r\nconst my_code = ref('');\r\n\r\nimport { postRegister,postCode,postCodeVeryfication } from \"@/api/api\"\r\nconst openRegister = ref(false);\r\nconst openVerification = ref(false);\r\n\r\nconst register = () => {\r\n  openRegister.value = true;\r\n};\r\n\r\nconst postmyRegister = async () =>{\r\n  try{\r\n    const response = await postRegister(my_id, my_name, my_password,my_email);\r\n    if(response.data.result){\r\n      ElMessage({\r\n        message: \"提交成功\",\r\n        type: \"success\",\r\n      });\r\n      localStorage.setItem('user_id',my_id);\r\n      localStorage.setItem('email',my_email);\r\n      localStorage.setItem('password',my_password);\r\n      localStorage.setItem('name',my_name);\r\n      openRegister.value = false;\r\n      openVerification.value = true;\r\n      \r\n    }else{\r\n      ElMessage.error(\"提交失败:\"+response.data.reason);\r\n    }\r\n  }catch (error) {\r\n    console.error(\"提交失败:\", error);\r\n  }\r\n}\r\n//发送验证码\r\n\r\nconst sendVerificationOk = async () =>{\r\n  try{\r\n    const response = await postCode(my_email);\r\n    if(response.data.result){\r\n      ElMessage({\r\n        message: \"成功发送验证码\",\r\n        type: \"success\",\r\n      });\r\n      if (!countingDown.value) {\r\n          startCountdown();\r\n           // 在这里发送验证码的逻辑\r\n        }\r\n    }else{\r\n      ElMessage.error(\"验证码发送失败\");\r\n    }\r\n  }catch (error) {\r\n    console.error(\"验证码发送失败:\", error);\r\n  }\r\n}\r\n\r\nconst handleVerificationOk = async () =>{\r\n  try{\r\n    const response = await postCodeVeryfication(my_code,my_email);\r\n    if(response.data.result){\r\n      ElMessage({\r\n        message: \"注册成功\",\r\n        type: \"success\",\r\n      });\r\n      openVerification.value = false;\r\n      localStorage.setItem('isLoggedIn',true);\r\n      updateUI();\r\n      //重新加载页面\r\n      window.location.href = window.location.href;\r\n    }else{\r\n      ElMessage.error(\"验证码错误，请重新输入\");\r\n    }\r\n  }catch (error) {\r\n    console.error(\"验证码发送失败:\", error);\r\n  }\r\n};\r\n//倒计时\r\nconst countdownSeconds = 120;\r\nconst countingDown = ref(false); \r\nconst buttonText = ref('发送验证码');\r\n\r\nfunction startCountdown() {\r\n  countingDown.value = true;\r\n  let seconds = countdownSeconds;\r\n  buttonText.value = `${seconds}s`;\r\n  const countdownInterval = setInterval(() => {\r\n    seconds--;\r\n    buttonText.value = `${seconds}s`;\r\n    if (seconds <= 0) {\r\n      clearInterval(countdownInterval);\r\n      countingDown.value = false;\r\n      buttonText.value = '发送验证码';\r\n    }\r\n  }, 1000);\r\n}\r\n\r\n\r\n\r\nconst handleRegisterOk = (e) => {\r\n  console.log(e);\r\n  if (my_id.value === \"\" || my_password.value === \"\" || my_email.value === \"\" || my_name === \"\") {\r\n    ElMessage({\r\n      message: \"还有没填写的信息\",\r\n      type: \"error\",\r\n      plain: true,\r\n    });\r\n  }else {\r\n    postmyRegister();\r\n  }\r\n};\r\n\r\nconst changeToRegister =()=>{\r\n  openLogin.value = false;\r\n  openRegister.value = true;\r\n  updateUI();\r\n}\r\n\r\n\r\n// 页面加载完成时执行\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n  // 更新页面元素的显示状态\r\n  updateUI();\r\n});\r\n\r\n// 更新页面元素显示状态的函数\r\nfunction updateUI() {\r\n  var isLoggedIn = localStorage.getItem('isLoggedIn');\r\n  \r\n  \r\n  // 根据 isLoggedIn 的值更新页面元素显示状态\r\n  if (isLoggedIn === 'true') {\r\n    document.getElementById('loginButton').style.display = 'none'; // 隐藏登录按钮\r\n    document.getElementById('loggedInMessage').style.display = 'block'; // 显示已登录的消息\r\n  } else {\r\n    document.getElementById('loginButton').style.display = 'block'; // 显示登录按钮\r\n    document.getElementById('loggedInMessage').style.display = 'none'; // 隐藏已登录的消息\r\n  }\r\n}\r\n//退出登录\r\n\r\nconst quit=()=>{\r\n  localStorage.setItem('user_id',\"\");\r\n  localStorage.setItem('isLoggedIn',false);\r\n  localStorage.setItem('email',\"\");\r\n  localStorage.setItem('password',\"\");\r\n  localStorage.setItem('name',\"\");\r\n  updateUI();\r\n}\r\n\r\nonMounted(() => {\r\n  router.push(\"/home/ticket\");\r\n  getAllMessage();\r\n});\r\nconst getAllMessage = async () => {\r\n  //TODO 判断是否登录\r\n  try {\r\n    const responce = await getMessage(userID);\r\n    message.value = responce.data.result;\r\n  } catch (error) {\r\n    console.log(\"获取消息失败\", error);\r\n  }\r\n};\r\nconst jumpToOrder = (orderType, orderId) => {\r\n  eventBus.HeaderKey = \"4\";\r\n  activeIndex.value = \"4\";\r\n  //TODO 依据不同情况修改\r\n  eventBus.MyOrdersActiveKey = orderType;\r\n  if (orderType === \"3\") {\r\n    router.push(\"/home/orders/ticketOrders\");\r\n    router.push({\r\n      path: \"/home/orders/ticketOrders\",\r\n      query: { orderId: orderId },\r\n    });\r\n  } else if (orderType === \"4\") {\r\n    router.push({\r\n      path: \"/home/orders/hotelOrders\",\r\n      query: { orderId: orderId },\r\n    });\r\n  } else if (orderType === \"5\") {\r\n    router.push({\r\n      path: \"/home/orders/foodOrders\",\r\n      query: { orderId: orderId },\r\n    });\r\n  }\r\n};\r\n\r\n// setInterval(getAllMessage,1000);\r\n</script>\r\n\r\n<style>\r\n.home-container {\r\n  width: 100%;\r\n  height: 100vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.el-header {\r\n  height: 60px;\r\n}\r\n\r\n* {\r\n  margin: 0;\r\n  padding: 0;\r\n}\r\n\r\n.main {\r\n  flex: 1;\r\n  display: flex;\r\n  align-items: stretch;\r\n}\r\n\r\n.header-content {\r\n  display: flex;\r\n  align-items: center;\r\n  padding-top: 8px;\r\n}\r\n\r\n.title {\r\n  align-self: center;\r\n  margin-right: auto;\r\n}\r\n\r\n.menu {\r\n  margin-left: 10%;\r\n}\r\n\r\n.menu-change {\r\n  height: 100%;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}