{"ast":null,"code":"import { onMounted, ref, watch } from \"vue\";\nimport { getHotelOrders, cancelHotelOrder } from \"../../api/api.js\";\nimport { ElMessage } from \"element-plus\";\nconst userID = \"0000\";\nexport default {\n  __name: 'hotel',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const status = ref(\"all\");\n    const hotelOrders = ref([]);\n    const cancelOrders = async oid => {\n      try {\n        const responce = await cancelHotelOrder(userID, oid);\n        if (responce.data.result) {\n          ElMessage({\n            message: '取消订单成功，退款将原路返回。',\n            type: \"success\"\n          });\n          //TODO 通知消息弹窗\n        } else {\n          ElMessage.error(\"取消订单失败\");\n        }\n      } catch (error) {\n        console.error(\"取消订单失败\", error);\n        ElMessage.error(\"取消订单失败\");\n      }\n      getOrders();\n    };\n    const getStatusColor = status => {\n      if (status === '已完成') {\n        return '#60B2FF';\n      } else if (status === '已支付') {\n        return '#24D36F';\n      } else if (status === '已取消') {\n        return '#FC604F';\n      }\n    };\n    const hideMiddle = val => {\n      return `${val.substring(0, 3)}************${val.substring(val.length - 3)}`;\n    };\n    const getOrders = async () => {\n      try {\n        const response = await getHotelOrders(userID, status.value);\n        console.log(status.value);\n        hotelOrders.value = response.data.result;\n      } catch (error) {\n        console.error(\"获取火车票订单数组失败:\", error);\n      }\n    };\n    watch(status, newValue => {\n      console.log(\"状态切换为\", newValue);\n      getOrders();\n    });\n    onMounted(() => {\n      getOrders();\n    });\n    const __returned__ = {\n      status,\n      userID,\n      hotelOrders,\n      cancelOrders,\n      getStatusColor,\n      hideMiddle,\n      getOrders,\n      onMounted,\n      ref,\n      watch,\n      get getHotelOrders() {\n        return getHotelOrders;\n      },\n      get cancelHotelOrder() {\n        return cancelHotelOrder;\n      },\n      get ElMessage() {\n        return ElMessage;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["onMounted","ref","watch","getHotelOrders","cancelHotelOrder","ElMessage","userID","status","hotelOrders","cancelOrders","oid","responce","data","result","message","type","error","console","getOrders","getStatusColor","hideMiddle","val","substring","length","response","value","log","newValue"],"sources":["D:/University/sophomore/Software engineering/werwer_train/src/components/orders/hotel.vue"],"sourcesContent":["<template>\r\n    <el-radio-group v-model=\"status\">\r\n        <el-radio-button label=\"全部订单\" value=\"all\"></el-radio-button>\r\n        <el-radio-button label=\"已支付\" value=\"paid\"></el-radio-button>\r\n        <el-radio-button label=\"已取消\" value=\"cancle\"></el-radio-button>\r\n        <el-radio-button label=\"已完成\" value=\"done\"></el-radio-button>\r\n    </el-radio-group>\r\n    <div v-for=\"(item, index) in hotelOrders\" :key=\"index\">\r\n        <el-card style=\"width: 100%;border-radius: 25px;margin-top:1%;margin-bottom:1%;\">\r\n            <template #header>\r\n                <el-row>\r\n                    <el-col :span=\"7\">\r\n                        <el-text tag=\"b\" size=\"large\">订单号: {{ item.oid }}</el-text>\r\n                    </el-col>\r\n                    <el-col :span=\"7\">\r\n                        <el-text tag=\"b\" size=\"large\">下单时间: {{ item.time }}</el-text>\r\n                    </el-col>\r\n                    <el-col :span=\"7\">\r\n                    </el-col>\r\n                    <el-col :span=\"3\">\r\n                        <el-text tag=\"b\" size=\"large\">订单状态: <span :style=\"{ color: getStatusColor(item.status) }\">{{\r\n                                item.status }}</span></el-text>\r\n                    </el-col>\r\n                </el-row>\r\n            </template>\r\n            <div style=\"display:block;\">\r\n                <div style=\"font-size:20px;font-weight:bold\">{{item.name}}</div>\r\n                <div style=\"font-size:14px;margin-top:5px;\">{{item.position}}</div>\r\n                <div style=\"font-size:14px;margin-top:5px;\">\r\n                入住日期: {{item.check_in}}至{{item.check_out}}\r\n                </div>\r\n                <div style=\"font-size:14px;margin-top:5px;\">{{item.roomtype}}</div>\r\n            </div>\r\n            \r\n           \r\n            <template #footer>\r\n                <el-row>\r\n                    <el-col :span=\"4\">\r\n                        <el-text class=\"mx-1\" size=\"large\">房间数: {{ item.num }}</el-text>\r\n                    </el-col>\r\n                    <el-col :span=\"3\">\r\n                        <el-text class=\"mx-1\" size=\"large\">总金额: <span style=\"color:#ffa31a;font-weight: bold;\">￥{{\r\n                            item.money\r\n                                }}元</span></el-text>\r\n                    </el-col>\r\n                    <el-col :span=\"2\" v-if=\"item.status === '已支付'\" :offset=\"15\">\r\n                        <el-popconfirm title=\"确定要取消这个订单吗？\" @confirm=\"cancelOrders(item.oid)\">\r\n                            <template #reference>\r\n                                <el-button size=\"large\" type=\"warning\" plain style=\"margin-top:-1%;\">取消订单</el-button>\r\n                            </template>\r\n                        </el-popconfirm>\r\n                    </el-col>\r\n                </el-row>\r\n            </template>\r\n        </el-card>\r\n    </div>\r\n</template>\r\n<script setup>\r\nimport { onMounted, ref, watch } from \"vue\";\r\nimport { getHotelOrders, cancelHotelOrder } from \"../../api/api.js\";\r\nimport { ElMessage } from \"element-plus\";\r\nconst status = ref(\"all\");\r\nconst userID = \"0000\";\r\nconst hotelOrders = ref([]);\r\nconst cancelOrders=async(oid)=>{\r\n    try {\r\n        const responce = await cancelHotelOrder(userID, oid);\r\n        if (responce.data.result) {\r\n            ElMessage({\r\n                message: '取消订单成功，退款将原路返回。',\r\n                type: \"success\",\r\n            });\r\n            //TODO 通知消息弹窗\r\n        }\r\n        else {\r\n            ElMessage.error(\"取消订单失败\");\r\n        }\r\n    } catch (error) {\r\n        console.error(\"取消订单失败\", error);\r\n        ElMessage.error(\"取消订单失败\");\r\n    }\r\n    getOrders();\r\n}\r\nconst getStatusColor = (status) => {\r\n    if (status === '已完成') {\r\n        return '#60B2FF';\r\n    } else if (status === '已支付') {\r\n        return '#24D36F';\r\n    } else if (status === '已取消') {\r\n        return '#FC604F';\r\n    }\r\n};\r\nconst hideMiddle = (val) => {\r\n    return `${val.substring(0, 3)}************${val.substring(val.length - 3)}`\r\n}\r\nconst getOrders = async () => {\r\n    try {\r\n        const response = await getHotelOrders(userID, status.value);\r\n        console.log(status.value);\r\n        hotelOrders.value = response.data.result;\r\n    } catch (error) {\r\n        console.error(\"获取火车票订单数组失败:\", error);\r\n    }\r\n};\r\nwatch(status, (newValue) => {\r\n    console.log(\"状态切换为\", newValue);\r\n    getOrders();\r\n});\r\nonMounted(() => {\r\n    getOrders();\r\n});\r\n</script>\r\n<style>\r\n.el-card .el-card__header {\r\n    background-color: #f0f8ff;\r\n}\r\n\r\n.scrollbar-flex-content {\r\n    display: flex;\r\n    margin-top: 1%;\r\n    justify-content: center;\r\n}\r\n\r\n.scrollbar-demo-item {\r\n    flex-shrink: 0;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    width: 300px;\r\n    height: 50px;\r\n    margin: 15px;\r\n    text-align: center;\r\n    border-radius: 4px;\r\n    background-color: #f0f8ff !important;\r\n}\r\n</style>"],"mappings":"AA0DA,SAASA,SAAS,EAAEC,GAAG,EAAEC,KAAK,QAAQ,KAAK;AAC3C,SAASC,cAAc,EAAEC,gBAAgB,QAAQ,kBAAkB;AACnE,SAASC,SAAS,QAAQ,cAAc;AAExC,MAAMC,MAAM,GAAG,MAAM;;;;;;;IADrB,MAAMC,MAAM,GAAGN,GAAG,CAAC,KAAK,CAAC;IAEzB,MAAMO,WAAW,GAAGP,GAAG,CAAC,EAAE,CAAC;IAC3B,MAAMQ,YAAY,GAAC,MAAMC,GAAG,IAAG;MAC3B,IAAI;QACA,MAAMC,QAAQ,GAAG,MAAMP,gBAAgB,CAACE,MAAM,EAAEI,GAAG,CAAC;QACpD,IAAIC,QAAQ,CAACC,IAAI,CAACC,MAAM,EAAE;UACtBR,SAAS,CAAC;YACNS,OAAO,EAAE,iBAAiB;YAC1BC,IAAI,EAAE;UACV,CAAC,CAAC;UACF;QACJ,CAAC,MACI;UACDV,SAAS,CAACW,KAAK,CAAC,QAAQ,CAAC;QAC7B;MACJ,CAAC,CAAC,OAAOA,KAAK,EAAE;QACZC,OAAO,CAACD,KAAK,CAAC,QAAQ,EAAEA,KAAK,CAAC;QAC9BX,SAAS,CAACW,KAAK,CAAC,QAAQ,CAAC;MAC7B;MACAE,SAAS,CAAC,CAAC;IACf,CAAC;IACD,MAAMC,cAAc,GAAIZ,MAAM,IAAK;MAC/B,IAAIA,MAAM,KAAK,KAAK,EAAE;QAClB,OAAO,SAAS;MACpB,CAAC,MAAM,IAAIA,MAAM,KAAK,KAAK,EAAE;QACzB,OAAO,SAAS;MACpB,CAAC,MAAM,IAAIA,MAAM,KAAK,KAAK,EAAE;QACzB,OAAO,SAAS;MACpB;IACJ,CAAC;IACD,MAAMa,UAAU,GAAIC,GAAG,IAAK;MACxB,OAAQ,GAAEA,GAAG,CAACC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAE,eAAcD,GAAG,CAACC,SAAS,CAACD,GAAG,CAACE,MAAM,GAAG,CAAC,CAAE,EAAC;IAC/E,CAAC;IACD,MAAML,SAAS,GAAG,MAAAA,CAAA,KAAY;MAC1B,IAAI;QACA,MAAMM,QAAQ,GAAG,MAAMrB,cAAc,CAACG,MAAM,EAAEC,MAAM,CAACkB,KAAK,CAAC;QAC3DR,OAAO,CAACS,GAAG,CAACnB,MAAM,CAACkB,KAAK,CAAC;QACzBjB,WAAW,CAACiB,KAAK,GAAGD,QAAQ,CAACZ,IAAI,CAACC,MAAM;MAC5C,CAAC,CAAC,OAAOG,KAAK,EAAE;QACZC,OAAO,CAACD,KAAK,CAAC,cAAc,EAAEA,KAAK,CAAC;MACxC;IACJ,CAAC;IACDd,KAAK,CAACK,MAAM,EAAGoB,QAAQ,IAAK;MACxBV,OAAO,CAACS,GAAG,CAAC,OAAO,EAAEC,QAAQ,CAAC;MAC9BT,SAAS,CAAC,CAAC;IACf,CAAC,CAAC;IACFlB,SAAS,CAAC,MAAM;MACZkB,SAAS,CAAC,CAAC;IACf,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}